<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VASynth v2 Test</title>
  <style>
    body {
      font-family: 'Courier New', monospace;
      background: #1a1a1a;
      color: #00ff00;
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    h1 {
      color: #00ff00;
      border-bottom: 2px solid #00ff00;
      padding-bottom: 10px;
    }

    .section {
      background: #2a2a2a;
      border: 1px solid #00ff00;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }

    .section h2 {
      margin-top: 0;
      color: #00ffff;
    }

    button {
      background: #00ff00;
      color: #1a1a1a;
      border: none;
      padding: 12px 24px;
      font-family: 'Courier New', monospace;
      font-weight: bold;
      font-size: 14px;
      cursor: pointer;
      border-radius: 4px;
      margin: 5px;
      transition: all 0.2s;
    }

    button:hover {
      background: #00ffff;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 255, 0, 0.3);
    }

    button:active {
      transform: translateY(0);
    }

    button:disabled {
      background: #555;
      color: #888;
      cursor: not-allowed;
      transform: none;
    }

    .keyboard {
      display: flex;
      gap: 2px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .key {
      width: 60px;
      height: 120px;
      background: white;
      color: black;
      border: 2px solid #333;
      border-radius: 0 0 4px 4px;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      padding-bottom: 10px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.1s;
    }

    .key:hover {
      background: #f0f0f0;
    }

    .key:active {
      background: #00ff00;
      transform: translateY(2px);
    }

    .key.black {
      background: #222;
      color: white;
      height: 80px;
      width: 40px;
      margin-left: -21px;
      margin-right: -21px;
      z-index: 10;
      position: relative;
    }

    .key.black:hover {
      background: #333;
    }

    .key.black:active {
      background: #00ff00;
    }

    .controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }

    .control {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .control label {
      color: #00ffff;
      font-size: 12px;
      font-weight: bold;
    }

    input[type="range"] {
      width: 100%;
      height: 4px;
      background: #444;
      outline: none;
      border-radius: 2px;
    }

    input[type="range"]::-webkit-slider-thumb {
      appearance: none;
      width: 16px;
      height: 16px;
      background: #00ff00;
      cursor: pointer;
      border-radius: 50%;
    }

    .value-display {
      color: #00ff00;
      font-size: 14px;
      font-weight: bold;
    }

    .metrics {
      background: #1a1a1a;
      border: 1px solid #00ffff;
      border-radius: 4px;
      padding: 15px;
      font-size: 12px;
    }

    .metrics-row {
      display: flex;
      justify-content: space-between;
      margin: 5px 0;
    }

    .metrics-label {
      color: #00ffff;
    }

    .metrics-value {
      color: #00ff00;
      font-weight: bold;
    }

    .log {
      background: #0a0a0a;
      border: 1px solid #00ff00;
      border-radius: 4px;
      padding: 15px;
      height: 200px;
      overflow-y: auto;
      font-size: 11px;
      font-family: 'Courier New', monospace;
    }

    .log-entry {
      margin: 2px 0;
    }

    .log-entry.info { color: #00ffff; }
    .log-entry.success { color: #00ff00; }
    .log-entry.warning { color: #ffff00; }
    .log-entry.error { color: #ff0000; }
  </style>
</head>
<body>
  <h1>🎹 VASynth v2 Test Suite</h1>

  <div class="section">
    <h2>Initialization</h2>
    <button id="init-btn">Initialize AudioContext</button>
    <button id="load-preset-btn" disabled>Load Bass Preset</button>
    <button id="load-lead-preset-btn" disabled>Load Lead Preset</button>
  </div>

  <div class="section">
    <h2>Virtual Keyboard</h2>
    <div class="keyboard" id="keyboard">
      <!-- Keys will be generated by JavaScript -->
    </div>
    <p style="color: #888; font-size: 12px;">
      Click keys to play notes, or use keyboard: A-K for white keys, W-I for black keys
    </p>
  </div>

  <div class="section">
    <h2>Oscillator Controls</h2>
    <div class="controls">
      <div class="control">
        <label>Osc 1 Level</label>
        <input type="range" id="osc1-level" min="0" max="100" value="60" disabled>
        <div class="value-display" id="osc1-level-value">60%</div>
      </div>

      <div class="control">
        <label>Osc 1 Detune</label>
        <input type="range" id="osc1-detune" min="-50" max="50" value="0" disabled>
        <div class="value-display" id="osc1-detune-value">0 cents</div>
      </div>

      <div class="control">
        <label>Unison Voices</label>
        <input type="range" id="unison-voices" min="1" max="8" value="4" step="1" disabled>
        <div class="value-display" id="unison-voices-value">4 voices</div>
      </div>

      <div class="control">
        <label>Unison Detune</label>
        <input type="range" id="unison-detune" min="0" max="50" value="10" disabled>
        <div class="value-display" id="unison-detune-value">10 cents</div>
      </div>
    </div>
  </div>

  <div class="section">
    <h2>Filter Controls</h2>
    <div class="controls">
      <div class="control">
        <label>Filter Cutoff</label>
        <input type="range" id="filter-cutoff" min="20" max="20000" value="8000" disabled>
        <div class="value-display" id="filter-cutoff-value">8000 Hz</div>
      </div>

      <div class="control">
        <label>Filter Resonance</label>
        <input type="range" id="filter-resonance" min="0.1" max="30" value="1" step="0.1" disabled>
        <div class="value-display" id="filter-resonance-value">1.0</div>
      </div>

      <div class="control">
        <label>Envelope Amount</label>
        <input type="range" id="filter-env-amount" min="-12000" max="12000" value="0" disabled>
        <div class="value-display" id="filter-env-amount-value">0 Hz</div>
      </div>
    </div>
  </div>

  <div class="section">
    <h2>Performance Metrics</h2>
    <div class="metrics" id="metrics">
      <div class="metrics-row">
        <span class="metrics-label">Active Voices:</span>
        <span class="metrics-value" id="active-voices">0</span>
      </div>
      <div class="metrics-row">
        <span class="metrics-label">Total Updates:</span>
        <span class="metrics-value" id="total-updates">0</span>
      </div>
      <div class="metrics-row">
        <span class="metrics-label">Avg Batch Size:</span>
        <span class="metrics-value" id="avg-batch">0</span>
      </div>
    </div>
  </div>

  <div class="section">
    <h2>Console Log</h2>
    <div class="log" id="log"></div>
    <button id="clear-log-btn">Clear Log</button>
  </div>

  <script type="module">
    // This is a test file - normally you'd import from actual modules
    // For now, we'll just create a basic test structure

    const log = (message, type = 'info') => {
      const logDiv = document.getElementById('log');
      const entry = document.createElement('div');
      entry.className = `log-entry ${type}`;
      entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      logDiv.appendChild(entry);
      logDiv.scrollTop = logDiv.scrollHeight;
    };

    let audioContext = null;
    let synth = null;

    // Initialize button
    document.getElementById('init-btn').addEventListener('click', async () => {
      try {
        log('Initializing AudioContext...', 'info');

        // Create AudioContext
        audioContext = new (window.AudioContext || window.webkitAudioContext)();

        log(`AudioContext created. Sample rate: ${audioContext.sampleRate} Hz`, 'success');
        log('⚠️  VASynth v2 modules need to be built first!', 'warning');
        log('This is a UI test template. Actual synth integration coming next.', 'info');

        // Enable controls
        document.querySelectorAll('button').forEach(btn => btn.disabled = false);
        document.querySelectorAll('input').forEach(input => input.disabled = false);
        document.getElementById('init-btn').disabled = true;

        log('Ready to test! 🎹', 'success');

      } catch (error) {
        log(`Error: ${error.message}`, 'error');
      }
    });

    // Generate keyboard
    const keyboard = document.getElementById('keyboard');
    const notes = [
      { note: 'C', midi: 60, white: true, key: 'A' },
      { note: 'C#', midi: 61, white: false, key: 'W' },
      { note: 'D', midi: 62, white: true, key: 'S' },
      { note: 'D#', midi: 63, white: false, key: 'E' },
      { note: 'E', midi: 64, white: true, key: 'D' },
      { note: 'F', midi: 65, white: true, key: 'F' },
      { note: 'F#', midi: 66, white: false, key: 'T' },
      { note: 'G', midi: 67, white: true, key: 'G' },
      { note: 'G#', midi: 68, white: false, key: 'Y' },
      { note: 'A', midi: 69, white: true, key: 'H' },
      { note: 'A#', midi: 70, white: false, key: 'U' },
      { note: 'B', midi: 71, white: true, key: 'J' },
      { note: 'C', midi: 72, white: true, key: 'K' },
    ];

    notes.forEach(({ note, midi, white, key }) => {
      const keyDiv = document.createElement('div');
      keyDiv.className = white ? 'key' : 'key black';
      keyDiv.textContent = note;
      keyDiv.dataset.midi = midi;
      keyDiv.dataset.key = key;

      keyDiv.addEventListener('mousedown', () => {
        log(`Note ON: ${note} (MIDI ${midi})`, 'info');
        // synth?.noteOn(midi, 100);
      });

      keyDiv.addEventListener('mouseup', () => {
        log(`Note OFF: ${note}`, 'info');
        // synth?.noteOff(midi);
      });

      keyboard.appendChild(keyDiv);
    });

    // Keyboard input
    const keyMap = new Map(notes.map(n => [n.key, n.midi]));
    const activeKeys = new Set();

    window.addEventListener('keydown', (e) => {
      const key = e.key.toUpperCase();
      if (keyMap.has(key) && !activeKeys.has(key)) {
        activeKeys.add(key);
        const midi = keyMap.get(key);
        log(`Note ON: MIDI ${midi} (Key: ${key})`, 'info');
        // synth?.noteOn(midi, 100);
      }
    });

    window.addEventListener('keyup', (e) => {
      const key = e.key.toUpperCase();
      if (keyMap.has(key)) {
        activeKeys.delete(key);
        const midi = keyMap.get(key);
        log(`Note OFF: MIDI ${midi}`, 'info');
        // synth?.noteOff(midi);
      }
    });

    // Controls
    const setupControl = (id, valueId, formatter) => {
      const control = document.getElementById(id);
      const valueDisplay = document.getElementById(valueId);

      control.addEventListener('input', (e) => {
        const value = parseFloat(e.target.value);
        valueDisplay.textContent = formatter(value);
        log(`Parameter: ${id} = ${formatter(value)}`, 'info');
        // Update synth parameter here
      });
    };

    setupControl('osc1-level', 'osc1-level-value', v => `${v}%`);
    setupControl('osc1-detune', 'osc1-detune-value', v => `${v} cents`);
    setupControl('unison-voices', 'unison-voices-value', v => `${v} voices`);
    setupControl('unison-detune', 'unison-detune-value', v => `${v} cents`);
    setupControl('filter-cutoff', 'filter-cutoff-value', v => `${v} Hz`);
    setupControl('filter-resonance', 'filter-resonance-value', v => v.toFixed(1));
    setupControl('filter-env-amount', 'filter-env-amount-value', v => `${v} Hz`);

    // Clear log
    document.getElementById('clear-log-btn').addEventListener('click', () => {
      document.getElementById('log').innerHTML = '';
    });

    // Metrics update (simulated)
    setInterval(() => {
      if (audioContext) {
        document.getElementById('active-voices').textContent = Math.floor(Math.random() * 8);
        document.getElementById('total-updates').textContent = Math.floor(Math.random() * 1000);
        document.getElementById('avg-batch').textContent = (Math.random() * 5).toFixed(1);
      }
    }, 100);

    log('VASynth v2 Test Suite loaded', 'success');
    log('Click "Initialize AudioContext" to begin', 'info');
  </script>
</body>
</html>
